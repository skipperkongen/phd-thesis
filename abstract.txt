Geographic maps are among the oldest and most important data visualizations known to mankind. Moreover, their design and use has been studied for several millennia and their subordinate processes, such as map generalization, are well understood. However, the web has impacted the field of mapping in a number of dramatic ways: (1) ready-to-use background maps have become a commodity that can be easily integrated into digital mapping applications. In contrast, thematic foreground layers offer great variability and cannot been commoditized to the same extent; (2) the typical map making professional has changed from a GIS specialist to a busy person with map making as a secondary skill. Today, thematic maps are produced by journalists, aid workers, amateur data enthusiasts, and scientists alike. Therefore it is crucial that this diverse group of map makers is provided with expressible thematic map design tools that support customized selection of data for maps in scenarios where time is a scarce resource; (3) The web provides access to massive data repositories for thematic maps and is itself a cause of prolific data creation. This calls for scalable map processing techniques that can handle the data volume and which play well with the predominant data models on the web; (4) maps are now consumed around the clock by a global audience. While historical maps were single-user or few-user interfaces, today's map interfaces must be designed for millions of people who concurrently consume maps anywhere and anytime.

To address the challenges of efficient point map design, scalable map processing, and scalable map distribution, this thesis proposes novel techniques in the area of database-supported maps: (a) Glossy SQL, and its prototype CVL, belong to a new class of concise declarative languages that allows map designers to specify holistic multi-scale selection of geographic information for maps. Glossy SQL supports biased random sampling of data subject to two types of user-defined constraints as well as custom objectives. The purpose of the language is to derive a target multi-scale database from a source database according to holistic specifications; (b) The Glossy SQL compiler allows Glossy SQL to be scalably executed in a spatial analytics system, such as a spatial relational database system. This technique allows unprecedented data volumes to be processed for maps. Scalable execution is achieved by translating Glossy SQL queries into pure relational algebra queries that can run natively in SQL-based spatial analytics systems. The implementation developed during this thesis supports the PostgreSQL dialect of SQL. The prototype implementation is a compiler that translates CVL into SQL and stored procedures; (c) TileHeat is a framework and basic algorithm for partial materialization of hot tile sets for scalable map distribution. The framework predicts future map workloads based on an access log of recent requests. 

The work presented in this thesis evolves the State of the Art from multiple points of departure. First, the Glossy selection system, as well as its prototype CVL, is an evolution of batch-oriented, selection-based map generalization systems. Batch-oriented generalization is appropriate for serving maps to large web audiences because the computationally-intensive map generalization process is decoupled from the highly-concurrent map serving process. Second, TileHeat is an evolution of map request prediction systems. While state-of-the-art map request prediction for maps focuses mostly on real-time prediction and a single user, TileHeat moves prediction back in time by many hours and holistically predicts requests for all users. As a result, the computationally-intensive tile materialization process can be scheduled for low-load time windows. The techniques for long-term prediction of map requests are partially inspired by prediction techniques that are used in financial systems.